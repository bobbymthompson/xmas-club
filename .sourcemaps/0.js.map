{"version":3,"sources":["../../src/pages/leaderboard/leaderboard.module.ts","../../src/pipes/sort-array-desc/sort-array-desc.ts","../../src/pages/leaderboard/leaderboard.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,mDAAgF;AAChF,iDAA2E;AAC3E,sCAAyC;AACzC,gDAAgD;AAChD,+CAAgD;AAehD,IAAa,iBAAiB,GAA9B;CAAiC;AAApB,iBAAiB;IAb7B,eAAQ,CAAC;QACR,YAAY,EAAE;YACZ,6BAAe;YACf,gCAAgB;YAChB,mCAAiB;SAClB;QACD,OAAO,EAAE;YACP,+BAAe,CAAC,QAAQ,CAAC,6BAAe,CAAC;SAC1C;QACD,OAAO,EAAE;YACP,6BAAe;SAChB;KACF,CAAC;GACW,iBAAiB,CAAG;AAApB,8CAAiB;;;;;;;;;;;;;;;;;ACnB9B,sCAAoD;AAKpD,IAAa,iBAAiB,GAA9B;IAEE,SAAS,CAAC,MAAa,EAAE,GAAG,IAAI;QAC9B,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;YACX,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,EAAC,CAAC,CAAC,CAAC;QAC7D,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,MAAM,CAAC,MAAM,CAAC;QAChB,CAAC;IACH,CAAC;CACF;AATY,iBAAiB;IAH7B,WAAI,CAAC;QACJ,IAAI,EAAE,UAAU;KACjB,CAAC;GACW,iBAAiB,CAS7B;AATY,8CAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACL9B,sCAA0C;AAC1C,gDAAgG;AAIhG,mCAAgC;AAEhC,sDAA0E;AAS1E,IAAa,eAAe,GAA5B;IAOE,YAAmB,OAAsB,EAChC,SAAoB,EACnB,YAAkC,EAClC,WAA8B;QAHrB,YAAO,GAAP,OAAO,CAAe;QAChC,cAAS,GAAT,SAAS,CAAW;QACnB,iBAAY,GAAZ,YAAY,CAAsB;QAClC,gBAAW,GAAX,WAAW,CAAmB;IAAI,CAAC;IAEvC,eAAe;;YAEnB,IAAI,CAAC,WAAW,EAAE,CAAC;YAEnB,IAAI,CAAC,KAAK,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;YAChD,IAAI,CAAC,SAAS,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,CAAC;YACrD,IAAI,CAAC,WAAW,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;YACzD,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAC5C,IAAI,OAAO,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAEjF,IAAI,MAAM,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,SAAS,EAAE,CAAC;YAGhE,MAAM,CAAC,OAAO,CAAC,CAAC,KAAY,EAAE,KAAK;gBACjC,KAAK,CAAC,YAAY,GAAG,EAAE,CAAC;gBAExB,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE;oBACxD,IAAI,KAAK,GAAG,EAAE,CAAC,KAAK,GAAG,EAAE,CAAC,KAAK,GAAG,EAAE,CAAC,KAAK,CAAC;oBAC3C,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;gBACzC,CAAC,CAAC,CAAC;gBAEH,2FAA2F;gBAC3F,EAAE,CAAC,CAAC,KAAK,CAAC,YAAY,CAAC,MAAM,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC;oBAEvD,oDAAoD;oBACpD,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;gBACjF,CAAC;gBAED,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oBAErE,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;gBACjF,CAAC;gBAED,gCAAgC;gBAChC,IAAI,KAAK,GAAW,CAAC,CAAC;gBACtB,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,KAAK;oBAC/B,KAAK,IAAI,KAAK,CAAC;gBACjB,CAAC,CAAC,CAAC;gBAEH,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;YACtB,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;gBAC7B,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC;YAC3B,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;QACzB,CAAC;KAAA;IAEO,mBAAmB,CAAC,UAAuB,EAAE,QAAgB;QAEnE,IAAI,SAAS,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,CAAC;QAEjE,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;YACd,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC;QACzB,CAAC;QAED,MAAM,CAAC,CAAC,CAAC;IACX,CAAC;IAEO,cAAc,CAAC,KAAY;QAEjC,MAAM,CAAC,KAAK,CAAC,IAAI,KAAK,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;IAC9C,CAAC;IAED,WAAW;QACT,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YACrC,OAAO,EAAE,gBAAgB;YACzB,mBAAmB,EAAE,IAAI;SAC1B,CAAC,CAAC;QACH,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IACzB,CAAC;CACF;AApFY,eAAe;IAL3B,yBAAS,EAAE;IACX,gBAAS,CAAC;QACT,QAAQ,EAAE,kBAAkB;OACG;KAChC,CAAC;kCAQyC;QACrB,yBAAS;QACL,mCAAoB;QACrB,YAAiB;GAV7B,eAAe,CAoF3B;AApFY,uC","file":"0.js","sourcesContent":["import { SortArrayDescPipe } from '../../pipes/sort-array-desc/sort-array-desc';\nimport { ReverseArrayPipe } from '../../pipes/reverse-array/reverse-array';\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LeaderboardPage } from './leaderboard';\n\n@NgModule({\n  declarations: [\n    LeaderboardPage,\n    ReverseArrayPipe,\n    SortArrayDescPipe\n  ],\n  imports: [\n    IonicPageModule.forChild(LeaderboardPage),\n  ],\n  exports: [\n    LeaderboardPage\n  ]\n})\nexport class LeaderboardModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/leaderboard/leaderboard.module.ts","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'sortdesc',\n})\nexport class SortArrayDescPipe implements PipeTransform {\n  \n  transform(values: [any], ...args) {\n    if (values) {\n      return values.sort((a, b) => { return b.total - a.total });\n    } else {\n      return values;\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/sort-array-desc/sort-array-desc.ts","import { Component } from '@angular/core';\nimport { IonicPage, Loading, LoadingController, NavController, NavParams } from 'ionic-angular';\nimport { WeeksProvider } from '../../providers/weeks-provider';\nimport { Score } from '../../models/score';\nimport { Observable } from 'rxjs/Observable';\nimport * as _ from 'underscore';\nimport { Week } from \"../../models/week\";\nimport { XmasClubDataProvider } from \"../../providers/xmas-club.provider\";\nimport { ReverseArrayPipe } from '../../pipes/reverse-array';\nimport { Scorecard } from \"../../models/scorecard\";\n\n@IonicPage()\n@Component({\n  selector: 'page-leaderboard',\n  templateUrl: 'leaderboard.html'\n})\nexport class LeaderboardPage {\n  priorWeek: Week;\n  currentWeek: Week;\n  scores: Score[]\n  weeks: Week[];\n  loading: Loading;\n\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private dataProvider: XmasClubDataProvider,\n    private loadingCtrl: LoadingController) { }\n\n  async ionViewDidEnter() {\n\n    this.showLoading();\n\n    this.weeks = await this.dataProvider.getWeeks();\n    this.priorWeek = await this.dataProvider.priorWeek();\n    this.currentWeek = await this.dataProvider.currentWeek();\n    console.log('Prior week: ', this.priorWeek);\n    let results = await this.dataProvider.getScorecardResults(this.currentWeek.week);\n\n    let scores = await this.dataProvider.scores.first().toPromise();\n\n\n    scores.forEach((score: Score, index) => {\n      score.sortedScores = [];\n      \n      _.values(_.sortBy(score.weeklyScores, 'week')).forEach((ws) => {\n        let total = ws.total ? ws.total : ws.score;\n        score.sortedScores.splice(0, 0, total);\n      });\n\n      /* If the scores don't match the week count, then the user hasn't submitted a sheet yet. */\n      if (score.sortedScores.length != this.currentWeek.week) {\n\n        /* To be safe, calculate the current weeks score. */\n        score.sortedScores.splice(0, 0, this.getCurrentWeekScore(results, score.$key));\n      }\n      /* If scores for this week haven't been pushed in, use the current weeks scores */\n      else if (score.sortedScores.length > 0 && score.sortedScores[0] == 0) {\n\n        score.sortedScores.splice(0, 1, this.getCurrentWeekScore(results, score.$key));\n      }\n\n      /* Calculate the total score. */\n      let total: number = 0;\n      score.sortedScores.forEach((value) => {\n        total += value;\n      });\n\n      score.total = total;\n    });\n\n    this.scores = scores.sort((a, b) => {\n      return b.total - a.total;\n    });\n\n    this.loading.dismiss();\n  }\n\n  private getCurrentWeekScore(scorecards: Scorecard[], nickname: string): number {\n\n    let scorecard = _.find(scorecards, s => s.nickname === nickname);\n\n    if (scorecard) {\n      return scorecard.score;\n    }\n\n    return 0;\n  }\n\n  private isWeeklyWinner(score: Score): boolean {\n\n    return score.$key === this.priorWeek.winner;\n  }\n\n  showLoading() {\n    this.loading = this.loadingCtrl.create({\n      content: 'Please wait...',\n      dismissOnPageChange: true\n    });\n    this.loading.present();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/leaderboard/leaderboard.ts"],"sourceRoot":""}