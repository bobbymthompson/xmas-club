{"version":3,"sources":["../../src/pages/week/week.module.ts","../../src/pages/week/week.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { WeekPage } from './week';\n\n@NgModule({\n  declarations: [\n    WeekPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(WeekPage),\n  ],\n  exports: [\n    WeekPage\n  ]\n})\nexport class WeekModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/week/week.module.ts","import { WeeksProvider } from '../../providers/weeks-provider';\nimport { XmasClubDataProvider } from '../../providers/xmas-club.provider';\nimport { cordovaWarn } from 'ionic-native/dist/esm';\nimport { GameResult } from '../../models/game-result';\nimport { Scorecard, Pick } from '../../models/scorecard';\nimport { Component } from '@angular/core';\nimport { IonicPage, Loading, LoadingController, NavController, NavParams } from 'ionic-angular';\nimport { ScorecardsProvider } from '../../providers/scorecards-provider';\nimport { User } from '../../models/user';\nimport * as _ from 'underscore';\nimport { Week } from \"../../models/week\";\nimport { LoginPage } from \"../login/login\";\nimport { Observable } from 'rxjs/Observable';\nimport { FirebaseObjectObservable, FirebaseListObservable } from 'angularfire2/database';\nimport { AuthProvider } from \"../../providers/auth.provider\";\n\n@IonicPage({\n  segment: 'week/:week'\n})\n@Component({\n  selector: 'page-week',\n  templateUrl: 'week.html',\n})\nexport class WeekPage {\n\n  week: Week;\n  scorecards: Scorecard[];\n  favorites: Scorecard[];\n  currentUserScorecard: Scorecard;\n  loading: Loading;\n\n\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private authProvider: AuthProvider,\n    private scorecardsProvider: ScorecardsProvider,\n    private dataProvider: XmasClubDataProvider,\n    private loadingCtrl: LoadingController) {\n\n    this.favorites = [];\n  }\n\n  async ionViewDidEnter() {\n\n    this.showLoading();\n\n    if (this.navParams.get('week')) {\n      this.week = await this.dataProvider.getWeek(parseInt(this.navParams.get('week')));\n    } else {\n      this.week = await this.dataProvider.currentWeek();\n    }\n\n    this.loadScorecards();\n\n    this.loading.dismiss();\n  }\n\n  public login() {\n    this.navCtrl.push(LoginPage);\n  }\n\n  public viewScorecard(scorecard: Scorecard) {\n\n    this.navCtrl.push('ScorecardPage', { week: this.week.week, nickname: scorecard.nickname });\n  }\n\n  public canCreateScorecard(): boolean {\n\n    if (!this.week) return false;\n\n    /* Only if the current user is authenticated */\n    if (!this.authProvider.isAuthenticated) return false;\n\n    /* Only if this is the current users doesn't already have a scorecard for this week */\n    if (this.doesCurrentUserHaveScorecardAlready()) return false;\n\n    /* Only if it is before the due date. */\n    if (new Date() >= new Date(this.week.dueDate)) return false;\n\n    return true;\n  }\n\n  private queriedForScorecard: boolean;\n  private doesCurrentUserHaveScorecardAlready(): boolean {\n\n    if (!this.currentUserScorecard) {\n\n      if (this.authProvider.isAuthenticated) {\n\n        if (!this.queriedForScorecard) {\n\n          this.queriedForScorecard = true;\n\n          this.scorecardsProvider.getScorecard(this.week.week, this.authProvider.user.nickname).first().toPromise().then(scorecard => {\n            if (scorecard) {\n              this.currentUserScorecard = scorecard;\n            } else {\n              console.log('No scorecard exists for user');\n            }\n\n          });\n        }\n      }\n    }\n    else {\n      return true;\n    }\n\n    return false;\n  }\n\n  public async createScorecard() {\n\n    console.log('Creating scorecard');\n    \n    /* Create a new scorecard. */\n    if (this.authProvider.isAuthenticated && this.authProvider.user != null) {\n\n      this.showLoading();\n\n      let scorecard = await this.scorecardsProvider.createScorecard(this.week.week, this.authProvider.user.nickname);\n      console.log('Scorecard created.');\n      this.navCtrl.push('ScorecardPage', { enableEditMode: true, week: this.week.week, nickname: this.authProvider.user.nickname });\n    }\n  }\n\n  public viewFavoriteScorecards() {\n\n  }\n\n  public viewAllScorecards() {\n\n  }\n\n  private async loadScorecards() {\n\n    let favorites: Array<Scorecard> = new Array<Scorecard>();\n\n    let scorecards = await this.dataProvider.getScorecardResults(this.week.week);\n\n    scorecards.forEach(scorecard => {\n\n      if (this.authProvider.isAuthenticated) {\n\n        /* Populate the current user into the favorites list. */\n        if (scorecard.nickname == this.authProvider.user.nickname) {\n          favorites.push(scorecard);\n        }\n\n        /* Populate any favorites for this user. */\n        if (this.authProvider.user.favorites) {\n\n          if (_.some<string>(this.authProvider.user.favorites, nickname => nickname == scorecard.nickname)) {\n            favorites.push(scorecard);\n          }\n        }\n      }\n\n    });\n\n    /* Uncomment to enable viewing of favorites. */\n    //this.favorites = _.sortBy(favorites, 'score').reverse();\n\n    this.scorecards = scorecards;\n  }\n\n  private canViewTieBreakerScore() : boolean {\n\n    if (this.authProvider.isAdministrator) {\n      return true;\n    }\n\n    /* Only if it is before the due date. */\n    if (new Date() >= new Date(this.week.dueDate)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  showLoading() {\n    this.loading = this.loadingCtrl.create({\n      content: 'Please wait...',\n      dismissOnPageChange: true\n    });\n    this.loading.present();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/week/week.ts"],"sourceRoot":""}