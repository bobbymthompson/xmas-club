{"version":3,"sources":["../../src/pages/leaderboard/leaderboard.module.ts","../../src/pipes/sort-array-desc/sort-array-desc.ts","../../src/pages/leaderboard/leaderboard.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { SortArrayDescPipe } from '../../pipes/sort-array-desc/sort-array-desc';\nimport { ReverseArrayPipe } from '../../pipes/reverse-array/reverse-array';\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LeaderboardPage } from './leaderboard';\n\n@NgModule({\n  declarations: [\n    LeaderboardPage,\n    ReverseArrayPipe,\n    SortArrayDescPipe\n  ],\n  imports: [\n    IonicPageModule.forChild(LeaderboardPage),\n  ],\n  exports: [\n    LeaderboardPage\n  ]\n})\nexport class LeaderboardModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/leaderboard/leaderboard.module.ts","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'sortdesc',\n})\nexport class SortArrayDescPipe implements PipeTransform {\n  \n  transform(values: [any], ...args) {\n    if (values) {\n      return values.sort((a, b) => { return b.total - a.total });\n    } else {\n      return values;\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/sort-array-desc/sort-array-desc.ts","import { Component } from '@angular/core';\nimport { IonicPage, Loading, LoadingController, NavController, NavParams } from 'ionic-angular';\nimport { WeeksProvider } from '../../providers/weeks-provider';\nimport { Score } from '../../models/score';\nimport { Observable } from 'rxjs/Observable';\nimport * as _ from 'underscore';\nimport { Week } from \"../../models/week\";\nimport { XmasClubDataProvider } from \"../../providers/xmas-club.provider\";\nimport { ReverseArrayPipe } from '../../pipes/reverse-array';\nimport { Scorecard } from \"../../models/scorecard\";\n\n@IonicPage()\n@Component({\n  selector: 'page-leaderboard',\n  templateUrl: 'leaderboard.html'\n})\nexport class LeaderboardPage {\n  currentWeek: Week;\n  scores: Score[]\n  weeks: Week[];\n  loading: Loading;\n\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private dataProvider: XmasClubDataProvider,\n    private loadingCtrl: LoadingController) { }\n\n  async ionViewDidEnter() {\n\n    this.showLoading();\n\n    this.weeks = await this.dataProvider.getWeeks();\n    this.currentWeek = await this.dataProvider.currentWeek();\n\n    let results = await this.dataProvider.getScorecardResults(this.currentWeek.week);\n\n    let scores = await this.dataProvider.scores.first().toPromise();\n\n    scores.forEach((score, index) => {\n      score.sortedScores = _.values(score.weeklyScores).map(ws => ws.score);\n\n      /* If scores for this week haven't been pushed in, use the current weeks scores */\n      if (score.sortedScores.length != this.currentWeek.week) {\n\n        score.sortedScores.splice(0, 0, this.getCurrentWeekScore(results, score.$key));\n      }\n\n      /* Calculate the total score. */\n      score.total = _.reduce(score.sortedScores, function (acc, n) {\n        var lastNum = acc.length > 0 ? acc[acc.length - 1] : 0;\n        acc.push(lastNum + n);\n        return acc;\n      }, []);\n\n      //score.total = _.reduce(score.sortedScores, (memo, num) => memo + num, 0);\n    });\n\n    this.scores = scores;\n\n    this.loading.dismiss();\n  }\n\n  private getCurrentWeekScore(scorecards: Scorecard[], nickname: string): number {\n\n    let scorecard = _.find(scorecards, s => s.nickname === nickname);\n\n    if (scorecard) {\n      return scorecard.score;\n    }\n\n    return 0;\n  }\n\n  showLoading() {\n    this.loading = this.loadingCtrl.create({\n      content: 'Please wait...',\n      dismissOnPageChange: true\n    });\n    this.loading.present();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/leaderboard/leaderboard.ts"],"sourceRoot":""}