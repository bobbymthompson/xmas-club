{"version":3,"sources":["../../src/pages/scorecard/scorecard.module.ts","../../src/pages/scorecard/scorecard.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ScorecardPage } from './scorecard';\n\n@NgModule({\n  declarations: [\n    ScorecardPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ScorecardPage),\n  ],\n  exports: [\n    ScorecardPage\n  ]\n})\nexport class ScorecardPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/scorecard/scorecard.module.ts","import { ScorecardsProvider } from '../../providers/scorecards-provider';\nimport { Component, ElementRef } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { Scorecard, Pick } from \"../../models/scorecard\";\nimport { XmasClubDataProvider } from '../../providers/xmas-club.provider';\nimport * as _ from 'underscore';\nimport * as moment from 'moment';\nimport { Week } from \"../../models/week\";\nimport { FirebaseObjectObservable } from \"angularfire2/database\";\nimport { AuthProvider } from \"../../providers/auth.provider\";\nimport { Observable } from \"rxjs/Rx\";\nimport { GameResult } from \"../../models/game-result\";\n\n@IonicPage()\n@Component({\n  selector: 'page-scorecard',\n  templateUrl: 'scorecard.html',\n})\nexport class ScorecardPage {\n  scorecard: Scorecard;\n  _scorecard: Observable<Scorecard>;\n  inEditMode: boolean;\n  dueDate: Date;\n  week: number;\n  tieBreakerScore: number;\n  tieBreakerGame: Pick;\n\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private scorecardsProvider: ScorecardsProvider,\n    private dataProvider: XmasClubDataProvider,\n    private authProvider: AuthProvider,\n    private elementRef: ElementRef) {\n\n    this.week = this.navParams.get('week');\n    this.scorecardsProvider.getScorecard(this.week, this.navParams.get('nickname')).first().toPromise().then(async (scorecard) => {\n\n      this.scorecard = scorecard;\n\n      if (scorecard) {\n\n        let theWeek = await this.dataProvider.getWeek(this.week);\n\n        this.tieBreakerScore = scorecard.tieBreakerScore;\n        this.dueDate = new Date(theWeek.dueDate);\n\n        let gameResults = await this.dataProvider.getGameResults(this.week);\n\n        console.log(`Due Date: ${this.dueDate.toISOString()} - Current Date: ${new Date().toISOString()}`);\n\n        /* Keep track of the previous pick for use in over/unders. */\n        let previousPick = null;\n        for (let pick of scorecard.picks) {\n\n          (<EditablePick>pick).team1Selected = (pick.selectedPick == 'Team1') ? true : false;\n          (<EditablePick>pick).team2Selected = (pick.selectedPick == 'Team2') ? true : false;\n\n          /* Use the previous picks teams when it is an over/under. */\n          if (pick.isOverUnder && pick.team1.toLowerCase() == 'over' && pick.team2.toLowerCase() == 'under') {\n            pick.team1 = previousPick.team1;\n            pick.team2 = previousPick.team2;\n          }\n\n          let result = this.dataProvider.calculatePickResult(theWeek, pick, gameResults);\n\n          pick.homeTeam = result.homeTeam;\n          pick.complete = result.complete;\n\n          if (pick.complete) {\n            pick.correct = result.correct;\n            pick.incorrect = !result.correct;\n          }\n\n          previousPick = pick;\n        }\n\n        this.tieBreakerGame = _.last(scorecard.picks);\n      }\n    });\n\n    if (this.navParams.get('enableEditMode')) {\n      this.inEditMode = true;\n    }\n  }\n\n  public isScorecardViewable(): boolean {\n\n    if (this.inEditMode) return true;\n\n    /* Only allow the user to view this scorecard if it is after the due date */\n    if (new Date() >= this.dueDate) {\n      return true;\n    }\n\n    if (this.scorecard && this.scorecard.nickname === this.authProvider.user.nickname) {\n      return true;\n    }\n\n    if (this.authProvider.isAdministrator) {\n      return true;\n    }\n\n    return false;\n  }\n\n  public canEditScorecard(): boolean {\n\n    if (this.inEditMode) return false;\n\n    if (!this.scorecard) return false;\n\n    /* Only if the current user is authenticated */\n    if (!this.authProvider.isAuthenticated) return false;\n\n    /* Only if this is the current users scorecard */\n    if (!this.scorecard || this.authProvider.user.nickname != this.scorecard.nickname) return false;\n\n    /* Only if it is before the due date. */\n    if (!this.dueDate || new Date() >= this.dueDate) return false;\n\n    return true;\n  }\n\n  public updateSelectedPick(pick: EditablePick, selectedTeam: string) {\n\n    if (selectedTeam == 'Team1') {\n\n      if (pick.team1Selected) {\n        pick.team2Selected = false;\n        pick.selectedPick = 'Team1';\n      } else {\n        pick.team2Selected = true;\n        pick.selectedPick = 'Team2';\n      }\n\n    } else if (selectedTeam == 'Team2') {\n\n      if (pick.team2Selected) {\n        pick.team1Selected = false;\n        pick.selectedPick = 'Team2';\n      } else {\n        pick.team1Selected = true;\n        pick.selectedPick = 'Team1';\n      }\n    }\n  }\n\n  public editScorecard() {\n    this.inEditMode = true;\n  }\n\n  public saveScorecard() {\n\n    this.scorecard.tieBreakerScore = this.tieBreakerScore;\n\n    this.scorecardsProvider.update(this.scorecard);\n\n    this.inEditMode = false;\n  }\n}\n\nexport interface EditablePick extends Pick {\n  team1Selected: boolean;\n  team2Selected: boolean;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/scorecard/scorecard.ts"],"sourceRoot":""}